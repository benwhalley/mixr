<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Sleep (centering) | MixR: Mixed Models in R</title>
  <meta name="description" content="Sleep (centering) | MixR: Mixed Models in R" />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="Sleep (centering) | MixR: Mixed Models in R" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Sleep (centering) | MixR: Mixed Models in R" />
  
  
  

<meta name="author" content="Ben Whalley" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="random-effects.html"/>
<link rel="next" href="mma.html"/>
<script src="libs/header-attrs-2.1/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="media/webex.css" rel="stylesheet" />
<link href="media/psystats.css" rel="stylesheet" />
<script src="media/webex.js"></script>
<script src="media/psystats.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-118343766-4"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
        dataLayer.push(arguments);
    }
    gtag('js', new Date());

    gtag('config', 'UA-118343766-4');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">MixR</a></li>

<li class="divider"></li>
<li><a href="index.html#section"></a></li>
<li class="chapter" data-level="" data-path="repeated-measures.html"><a href="repeated-measures.html"><i class="fa fa-check"></i>Repeated measures</a>
<ul>
<li class="chapter" data-level="" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html"><i class="fa fa-check"></i>Mixed models</a>
<ul>
<li class="chapter" data-level="" data-path="piglets-random-slope.html"><a href="piglets-random-slope.html"><i class="fa fa-check"></i>Piglets (random intercepts)</a></li>
<li><a href="r2-for-mixed-models.html#r2-for-mixed-models"><span class="math inline">\(R^2\)</span> for mixed models</a></li>
<li class="chapter" data-level="" data-path="random-slopes.html"><a href="random-slopes.html"><i class="fa fa-check"></i>Random slopes</a></li>
<li class="chapter" data-level="" data-path="likelihood-ratio-tests.html"><a href="likelihood-ratio-tests.html"><i class="fa fa-check"></i>Likelihood ratio tests</a></li>
<li class="chapter" data-level="" data-path="school-leavers-longer-exercise.html"><a href="school-leavers-longer-exercise.html"><i class="fa fa-check"></i>Scottish school leavers data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="random-effects.html"><a href="random-effects.html"><i class="fa fa-check"></i>Random effects</a>
<ul>
<li class="chapter" data-level="" data-path="sleep-centering.html"><a href="sleep-centering.html"><i class="fa fa-check"></i>Sleep (centering)</a></li>
<li class="chapter" data-level="" data-path="mma.html"><a href="mma.html"><i class="fa fa-check"></i>MMA</a></li>
<li class="chapter" data-level="" data-path="politeness.html"><a href="politeness.html"><i class="fa fa-check"></i>Politeness</a></li>
<li class="chapter" data-level="" data-path="anova-in-mixed-models.html"><a href="anova-in-mixed-models.html"><i class="fa fa-check"></i>Anova in mixed models</a></li>
<li class="chapter" data-level="" data-path="further-reading.html"><a href="further-reading.html"><i class="fa fa-check"></i>Further reading</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-estimation.html"><a href="bayesian-estimation.html"><i class="fa fa-check"></i>Bayesian estimation</a></li>
<li class="chapter" data-level="" data-path="assessment.html"><a href="assessment.html"><i class="fa fa-check"></i>Assessment</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://creativecommons.org/licenses/by-sa/4.0/" target="blank">Licence: CC BY-SA 4</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">MixR: Mixed Models in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sleep-centering" class="section level2">
<h2>Sleep (centering)</h2>
<p>In the previous session we saw how random intercepts can be used to fit different slopes for different individuals (or groupings) in the data.</p>
<p>The following data show the increased in reaction times over the course of a 10 days experiment in which participants suffered sleep deprivation:</p>
<div id="sleepplot" class="section level5">
<h5></h5>
<p><img src="03-random-effects_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<div class="exercise">
<ul>
<li>Is there substantial variation between subjects in reaction times on average?</li>
<li>Is there substantial variation in the effect of sleep deprivation?</li>
</ul>
<div class="solution">
<button class="solution-button">
Solution
</button>
<p>There’s certainly variation in the slopes between individuals, and the effect of sleep deprivation does seem to differ markedly between individuals.</p>
<p>However, deciding whether there is variation between people on average is less clear-cut. We need to decide on which day we want to compare the variation. For example, at day 0 there doesn’t seem to be much variation. But by day 5 there does, and by day 10 there is a lot.</p>
<p>As we’ll see, to estimate this variation from a model we need to be careful about how we include our covariates (e.g. days in this case).</p>
</div>
</div>
</div>
<div id="centering-coefficients" class="section level4">
<h4>Centering coefficients</h4>
<p>The plot above was based on the following random slopes model:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="sleep-centering.html#cb1-1"></a>(sleep.m1 &lt;-<span class="st"> </span><span class="kw">lmer</span>(Reaction <span class="op">~</span><span class="st"> </span>Days <span class="op">+</span><span class="st"> </span>(Days <span class="op">|</span><span class="st"> </span>Subject), ss))</span></code></pre></div>
<pre><code>Linear mixed model fit by REML [&#39;lmerModLmerTest&#39;]
Formula: Reaction ~ Days + (Days | Subject)
   Data: ss
REML criterion at convergence: 1743.628
Random effects:
 Groups   Name        Std.Dev. Corr
 Subject  (Intercept) 24.737       
          Days         5.923   0.07
 Residual             25.592       
Number of obs: 180, groups:  Subject, 18
Fixed Effects:
(Intercept)         Days  
     251.41        10.47  </code></pre>
<p>If we look at the dataset, we can see that there are 10 rows for each <code>Subject</code>, with days indexed from 0 to 9.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="sleep-centering.html#cb3-1"></a>sleepstudy <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>(<span class="dv">15</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</span></code></pre></div>
<table style="width:39%;">
<colgroup>
<col width="15%" />
<col width="9%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Reaction</th>
<th align="center">Days</th>
<th align="center">Subject</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">249.6</td>
<td align="center">0</td>
<td align="center">308</td>
</tr>
<tr class="even">
<td align="center">258.7</td>
<td align="center">1</td>
<td align="center">308</td>
</tr>
<tr class="odd">
<td align="center">250.8</td>
<td align="center">2</td>
<td align="center">308</td>
</tr>
<tr class="even">
<td align="center">321.4</td>
<td align="center">3</td>
<td align="center">308</td>
</tr>
<tr class="odd">
<td align="center">356.9</td>
<td align="center">4</td>
<td align="center">308</td>
</tr>
<tr class="even">
<td align="center">414.7</td>
<td align="center">5</td>
<td align="center">308</td>
</tr>
<tr class="odd">
<td align="center">382.2</td>
<td align="center">6</td>
<td align="center">308</td>
</tr>
<tr class="even">
<td align="center">290.1</td>
<td align="center">7</td>
<td align="center">308</td>
</tr>
<tr class="odd">
<td align="center">430.6</td>
<td align="center">8</td>
<td align="center">308</td>
</tr>
<tr class="even">
<td align="center">466.4</td>
<td align="center">9</td>
<td align="center">308</td>
</tr>
<tr class="odd">
<td align="center">222.7</td>
<td align="center">0</td>
<td align="center">309</td>
</tr>
<tr class="even">
<td align="center">205.3</td>
<td align="center">1</td>
<td align="center">309</td>
</tr>
<tr class="odd">
<td align="center">203</td>
<td align="center">2</td>
<td align="center">309</td>
</tr>
<tr class="even">
<td align="center">204.7</td>
<td align="center">3</td>
<td align="center">309</td>
</tr>
<tr class="odd">
<td align="center">207.7</td>
<td align="center">4</td>
<td align="center">309</td>
</tr>
</tbody>
</table>
<p>As we know from linear regression, when we include parameters thet estimated in such a way that when we look at them individually they are the estimate for an individual row <strong><em>if all the other predictors were set to zero</em></strong>.</p>
<p>In multiple regression this is important because it affects how we interpret the paramaters. When we include multiple predictors it can be hard to read the table of model parameters because we need to add together multiple paramaters to make a prediction. We can get around this using the <code>predict</code> function, but the key is that the scale of the</p>
<p>For example, if we use the mtcars data we can see that to estimate a heavy automatic car (high <code>wt</code> and <code>am</code>=1), we would have to do some arithmetic:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="sleep-centering.html#cb4-1"></a><span class="kw">lm</span>(mpg<span class="op">~</span>wt<span class="op">*</span>am, <span class="dt">data=</span>mtcars)</span></code></pre></div>
<pre><code>
Call:
lm(formula = mpg ~ wt * am, data = mtcars)

Coefficients:
(Intercept)           wt           am        wt:am  
     31.416       -3.786       14.878       -5.298  </code></pre>
<p>Because weight in this sample ranges from 1.513 to 5.424, simply adding the intercpt, <code>wt</code> and <code>am</code> paramaters would not be an estimate for any car in the sample, because none of them had zero weight.</p>
<p>If, on the other hand, we had <strong><em>mean-centered</em></strong> <code>wt</code> — that is, subtracted the mean from each value — then we could interpret the other coefficients as being the prediction when <em><code>wt</code> was at the average value in the sample</em>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="sleep-centering.html#cb6-1"></a>mt2 &lt;-<span class="st"> </span>mtcars <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">wt =</span> wt <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(wt))</span>
<span id="cb6-2"><a href="sleep-centering.html#cb6-2"></a><span class="kw">lm</span>(mpg<span class="op">~</span>wt<span class="op">*</span>am, <span class="dt">data=</span>mt2)</span></code></pre></div>
<pre><code>
Call:
lm(formula = mpg ~ wt * am, data = mt2)

Coefficients:
(Intercept)           wt           am        wt:am  
     19.236       -3.786       -2.168       -5.298  </code></pre>
<p>By centering the <code>wt</code> predictor the other coefficients change (although the model itself is really the same—the amount of variance explained is identical, for instance):</p>
<div class="solution">
<button class="solution-button">
Show R squared figures
</button>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="sleep-centering.html#cb8-1"></a><span class="co"># original</span></span>
<span id="cb8-2"><a href="sleep-centering.html#cb8-2"></a>broom<span class="op">::</span><span class="kw">glance</span>(<span class="kw">lm</span>(mpg<span class="op">~</span>wt<span class="op">*</span>am, <span class="dt">data=</span>mtcars)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(r.squared)</span></code></pre></div>
<pre><code>[1] 0.8330375</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="sleep-centering.html#cb10-1"></a><span class="co"># centered</span></span>
<span id="cb10-2"><a href="sleep-centering.html#cb10-2"></a>broom<span class="op">::</span><span class="kw">glance</span>(<span class="kw">lm</span>(mpg<span class="op">~</span>wt<span class="op">*</span>am, <span class="dt">data=</span>mt2)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(r.squared)</span></code></pre></div>
<pre><code>[1] 0.8330375</code></pre>
</div>
</div>
<div id="why-centering-matters-especially-for-mixed-models" class="section level4">
<h4>Why centering matters especially for mixed models</h4>
<p>In multiple regression centering predictors can be a convenience, but doesn’t affect the model fit<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>. We can always do arithmetic on our coefficients to convert from one configuration to the another when making predictions.</p>
<p><strong><em>This is not true for mixed models</em></strong>. How we include predictors changes estimates for our variance paramaters. To see why, consider the example we began with, from the <code>sleepstudy</code> data:</p>
<p><img src="images/sleeprandomslopes.png" /></p>
<p>If we centered the Days coefficient, the plot would look like this:</p>
<pre><code>Linear mixed model fit by REML [&#39;lmerModLmerTest&#39;]
Formula: Reaction ~ Days + (Days | Subject)
   Data: ss
REML criterion at convergence: 1743.628
Random effects:
 Groups   Name        Std.Dev. Corr
 Subject  (Intercept) 24.737       
          Days         5.923   0.07
 Residual             25.592       
Number of obs: 180, groups:  Subject, 18
Fixed Effects:
(Intercept)         Days  
     251.41        10.47  </code></pre>
<pre><code>Linear mixed model fit by REML [&#39;lmerModLmerTest&#39;]
Formula: Reaction ~ Days.c + (Days.c | Subject)
   Data: ss
REML criterion at convergence: 1743.628
Random effects:
 Groups   Name        Std.Dev. Corr
 Subject  (Intercept) 37.522       
          Days.c       5.921   0.75
 Residual             25.593       
Number of obs: 180, groups:  Subject, 18
Fixed Effects:
(Intercept)       Days.c  
     298.51        10.47  </code></pre>
<p><img src="03-random-effects_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>Nothing has changed, <em>except the scale of the x axis</em>. The x axis is now <code>Days.c</code> which ranges from -5 to 5, and 0 is in the middle; previously <code>Days</code> ranged from 0 to 9, with 5 as the midpoint.</p>
<p>BUT this small change is important because our paramaters are estimates when all the <em>other</em> predictors = zero.</p>
<p>This means that when we use the centered predictor our random intercept variance — the variation between people — is estimated for the midpoint of the study, because day 5 is coded as zero in <code>Days.c</code>.</p>
<p>We can see the effect on the variance paramaters if we compare the output of VarCorr. First uncentered:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="sleep-centering.html#cb14-1"></a><span class="kw">VarCorr</span>(sleep.m1)</span></code></pre></div>
<pre><code> Groups   Name        Std.Dev. Corr 
 Subject  (Intercept) 24.7366       
          Days         5.9229  0.066
 Residual             25.5918       </code></pre>
<p>And then centered:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="sleep-centering.html#cb16-1"></a><span class="kw">VarCorr</span>(sleep.m1.c)</span></code></pre></div>
<pre><code> Groups   Name        Std.Dev. Corr 
 Subject  (Intercept) 37.5221       
          Days.c       5.9212  0.753
 Residual             25.5930       </code></pre>
<p>When we centre <code>Days</code> then the proportion of variance attributed to subjects changes from about 80% to over 86%.</p>
<hr />
<p>This plot simplifies and shows the difference between models with centered and uncentered predictors. The vertical dashed lines show where the variance for the random intercept would be taken from in each case:</p>
<p><img src="03-random-effects_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="whats-the-right-thing-to-do" class="section level4">
<h4>What’s the right thing to do?</h4>
<p>It depends on what your question is!</p>
<p>In the <code>sleepstudy</code> example we might argue that the first (uncentered) model makes more sense because there is a definite start to the experiment: At Day 0 we have people in their ‘natural’ state, before we deprive them of sleep. So in this model the <code>(Intercept)</code> term describes the varation between people in the normal state.</p>
<p>However in other cases this wouldn’t be true. For example, let’s say we used the Scottish schools data and included the <code>year</code> each cohort was taken in as a predictor:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="sleep-centering.html#cb18-1"></a>schools<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">lmer</span>(score <span class="op">~</span><span class="st"> </span>year <span class="op">+</span><span class="st"> </span>(year<span class="op">|</span>schoolid), <span class="dt">data=</span>schools)</span>
<span id="cb18-2"><a href="sleep-centering.html#cb18-2"></a><span class="kw">VarCorr</span>(schools<span class="fl">.1</span>)                  </span></code></pre></div>
<pre><code> Groups   Name        Std.Dev.  Corr  
 schoolid (Intercept) 14.770619       
          year         0.011085 -1.000
 Residual             14.796990       </code></pre>
<p>Now, the between-school variance is estimated in the year 0 (i.e. &gt;2000 years ago), which clearly doesn’t make much sense. If we compare the ICC (or % variance-attributable) within and between schools it makes a huge difference:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="sleep-centering.html#cb20-1"></a>schools<span class="fl">.2</span> &lt;-<span class="st"> </span><span class="kw">lmer</span>(score <span class="op">~</span><span class="st"> </span>cohort90 <span class="op">+</span><span class="st"> </span>(cohort90<span class="op">|</span>schoolid), <span class="dt">data=</span>schools)</span>
<span id="cb20-2"><a href="sleep-centering.html#cb20-2"></a></span>
<span id="cb20-3"><a href="sleep-centering.html#cb20-3"></a><span class="kw">bind_rows</span>(</span>
<span id="cb20-4"><a href="sleep-centering.html#cb20-4"></a>  <span class="kw">VarCorr</span>(schools<span class="fl">.1</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">Centered=</span><span class="st">&quot;No&quot;</span>),</span>
<span id="cb20-5"><a href="sleep-centering.html#cb20-5"></a>  <span class="kw">VarCorr</span>(schools<span class="fl">.2</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">Centered=</span><span class="st">&quot;Yes&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb20-6"><a href="sleep-centering.html#cb20-6"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">is.na</span>(var2)) <span class="op">%&gt;%</span></span>
<span id="cb20-7"><a href="sleep-centering.html#cb20-7"></a><span class="st">  </span><span class="kw">group_by</span>(Centered) <span class="op">%&gt;%</span></span>
<span id="cb20-8"><a href="sleep-centering.html#cb20-8"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">icc=</span><span class="kw">round</span>(vcov <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(vcov) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>, <span class="dv">2</span>)) <span class="op">%&gt;%</span></span>
<span id="cb20-9"><a href="sleep-centering.html#cb20-9"></a><span class="st">  </span><span class="kw">select</span>(grp, var1, icc) <span class="op">%&gt;%</span></span>
<span id="cb20-10"><a href="sleep-centering.html#cb20-10"></a><span class="st">  </span><span class="kw">rename</span>(<span class="dt">Grouping=</span>grp, <span class="dt">Parameter=</span>var1, <span class="st">`</span><span class="dt">%</span><span class="st">`</span>=icc) <span class="op">%&gt;%</span></span>
<span id="cb20-11"><a href="sleep-centering.html#cb20-11"></a><span class="st">  </span><span class="kw">pander</span>()</span></code></pre></div>
<table style="width:61%;">
<colgroup>
<col width="15%" />
<col width="15%" />
<col width="19%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Centered</th>
<th align="center">Grouping</th>
<th align="center">Parameter</th>
<th align="center">%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">No</td>
<td align="center">schoolid</td>
<td align="center">(Intercept)</td>
<td align="center">49.91</td>
</tr>
<tr class="even">
<td align="center">No</td>
<td align="center">schoolid</td>
<td align="center">year</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center">No</td>
<td align="center">Residual</td>
<td align="center">NA</td>
<td align="center">50.09</td>
</tr>
<tr class="even">
<td align="center">Yes</td>
<td align="center">schoolid</td>
<td align="center">(Intercept)</td>
<td align="center">16.6</td>
</tr>
<tr class="odd">
<td align="center">Yes</td>
<td align="center">schoolid</td>
<td align="center">cohort90</td>
<td align="center">0.06</td>
</tr>
<tr class="even">
<td align="center">Yes</td>
<td align="center">Residual</td>
<td align="center">NA</td>
<td align="center">83.34</td>
</tr>
</tbody>
</table>
<p>In this case it makes no sense to estimate the variance when <code>year</code> = 0 and we should definitely center the variables.</p>
<p><strong>If you’re not sure, however, it’s probably safer to center predictors in mixed models.</strong></p>
<div class="exercise">
<p>Return to the piglets example from sessions 1 and 2.</p>
<ul>
<li>Refit the model with centered predictors</li>
<li>Calculate the variance partition by differences between piglets using centered and uncentered models. What differences do you spot?</li>
<li>Which parameterisation most sense in this case? Are we more interested in variation between pigs at the start or the middle of the study?</li>
</ul>
</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>This is mostly true. The only exception is when parameters are collinear (see PSYC753 materials); in this case numerical issues when fitting models can lead to small differences, but this is mostly not the case.<a href="sleep-centering.html#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="random-effects.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="mma.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
