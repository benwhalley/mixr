<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Assessment | MixR: Mixed Models in R</title>
  <meta name="description" content="Assessment | MixR: Mixed Models in R" />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="Assessment | MixR: Mixed Models in R" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Assessment | MixR: Mixed Models in R" />
  
  
  

<meta name="author" content="Ben Whalley" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="further-reading.html"/>
<link rel="next" href="references.html"/>
<script src="libs/header-attrs-2.1/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="media/webex.css" rel="stylesheet" />
<link href="media/psystats.css" rel="stylesheet" />
<script src="media/webex.js"></script>
<script src="media/psystats.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-118343766-4"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
        dataLayer.push(arguments);
    }
    gtag('js', new Date());

    gtag('config', 'UA-118343766-4');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">MixR</a></li>

<li class="divider"></li>
<li><a href="index.html#section"></a></li>
<li class="chapter" data-level="" data-path="repeated-measures.html"><a href="repeated-measures.html"><i class="fa fa-check"></i>Repeated measures</a>
<ul>
<li class="chapter" data-level="" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html"><i class="fa fa-check"></i>Mixed models</a>
<ul>
<li class="chapter" data-level="" data-path="piglets-random-slope.html"><a href="piglets-random-slope.html"><i class="fa fa-check"></i>Piglets (random intercepts)</a></li>
<li><a href="r2-for-mixed-models.html#r2-for-mixed-models"><span class="math inline">\(R^2\)</span> for mixed models</a></li>
<li class="chapter" data-level="" data-path="random-slopes.html"><a href="random-slopes.html"><i class="fa fa-check"></i>Random slopes</a></li>
<li class="chapter" data-level="" data-path="likelihood-ratio-tests.html"><a href="likelihood-ratio-tests.html"><i class="fa fa-check"></i>Likelihood ratio tests</a></li>
<li class="chapter" data-level="" data-path="school-leavers-longer-exercise.html"><a href="school-leavers-longer-exercise.html"><i class="fa fa-check"></i>Scottish school leavers data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="random-effects.html"><a href="random-effects.html"><i class="fa fa-check"></i>Random effects</a>
<ul>
<li class="chapter" data-level="" data-path="sleep-centering.html"><a href="sleep-centering.html"><i class="fa fa-check"></i>Sleep (centering)</a></li>
<li class="chapter" data-level="" data-path="mma.html"><a href="mma.html"><i class="fa fa-check"></i>MMA</a></li>
<li class="chapter" data-level="" data-path="politeness.html"><a href="politeness.html"><i class="fa fa-check"></i>Politeness</a></li>
<li class="chapter" data-level="" data-path="model-complexity.html"><a href="model-complexity.html"><i class="fa fa-check"></i>Model complexity</a></li>
<li class="chapter" data-level="" data-path="extensions.html"><a href="extensions.html"><i class="fa fa-check"></i>Extensions</a></li>
<li class="chapter" data-level="" data-path="further-reading.html"><a href="further-reading.html"><i class="fa fa-check"></i>Further reading</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="assessment.html"><a href="assessment.html"><i class="fa fa-check"></i>Assessment</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://creativecommons.org/licenses/by-sa/4.0/" target="blank">Licence: CC BY-SA 4</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">MixR: Mixed Models in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="assessment" class="section level1">
<h1>Assessment</h1>
<p>The REFRAMED trial was a large RCT evaluating a variant of dialectical behaviour therapy
for patients with treatment-resistant depression <span class="citation">(Lynch et al. <a href="#ref-lynch2018radically" role="doc-biblioref">2018</a>)</span>. The design of
the study is described in detail in <span class="citation">Lynch et al. (<a href="#ref-lynch2015refractory" role="doc-biblioref">2015</a>)</span>.</p>
<p>The original, uncentered data, used for this analysis are
<a href="data/reframed.csv">available here: <code>data/reframed.csv</code></a>.</p>
<ol style="list-style-type: decimal">
<li>Make a plot which shows changes in PHQ9 scores over time, split by group. It can
either look like the plot below, or display the differences between groups over time
in another appropriate way:</li>
</ol>
<div class="figure">
<img src="images/reframedplotassess.png" alt="" />
<p class="caption">Changes in PHQ9 Scores during the REFRAMED trial</p>
</div>
<ol start="2" style="list-style-type: decimal">
<li><p>Fit a random intercepts model using <code>lmer</code>, including month as a fixed factor (a
categorical variable). Also include treatment group, and the interaction of month and
group.</p></li>
<li><p>Report the model you run and interpret the model output, and report relevant
statistics covered during the course. Be sure to report the % variance attributable
to between-patient differences. Use the guidelines in <span class="citation">Meteyard and Davies (<a href="#ref-meteyard2020best" role="doc-biblioref">2020</a>)</span> when deciding
what to report.</p></li>
<li><p>Examine the code and output below. The variable <code>phq9.c</code> is a copy of the original
dataset in which all the numeric variables have been mean-centered.</p></li>
</ol>
<ul>
<li><p>Give a descriptive label/subtitle to each of the sections A to D below.</p></li>
<li><p>Comment on each line in the code, explaining what it does, and what the output (if
any) means. Use the R help files as a reference to functions if needed.</p></li>
<li><p>With reference to the plot above, why do you think that observations after month 12
are excluded from this analysis? Given the model formula used and the design of the
study, what other observations might it be reasonable to exclude?</p></li>
<li><p>Which model should we prefer, <code>phq9.m2</code> or <code>phq9.m3</code>?</p></li>
<li><p>Is model <code>phq9.m3</code> ‘maximal’ <span class="citation">Barr et al. (<a href="#ref-barr2013random" role="doc-biblioref">2013</a>)</span>?</p></li>
</ul>
<p>Section A:</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="assessment.html#cb110-1"></a>phq9.c2 &lt;-<span class="st"> </span>phq9.c <span class="op">%&gt;%</span></span>
<span id="cb110-2"><a href="assessment.html#cb110-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">tx=</span><span class="kw">ifelse</span>(grp<span class="op">==</span><span class="st">&quot;TAU&quot;</span>, <span class="dv">0</span>, <span class="dv">1</span>)) <span class="op">%&gt;%</span></span>
<span id="cb110-3"><a href="assessment.html#cb110-3"></a><span class="st">  </span><span class="kw">filter</span>(month <span class="op">&lt;</span><span class="st"> </span><span class="dv">12</span>)</span></code></pre></div>
<p>Section B:</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="assessment.html#cb111-1"></a>phq9.m2 &lt;-<span class="st"> </span><span class="kw">lmer</span>(phq9 <span class="op">~</span><span class="st"> </span>month <span class="op">*</span><span class="st"> </span>tx <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>patient), <span class="dt">data=</span>phq9.c2)</span>
<span id="cb111-2"><a href="assessment.html#cb111-2"></a>phq9.m3 &lt;-<span class="st"> </span><span class="kw">lmer</span>(phq9 <span class="op">~</span><span class="st"> </span>month <span class="op">*</span><span class="st"> </span>tx <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>month<span class="op">:</span>tx <span class="op">|</span><span class="st"> </span>patient), <span class="dt">data=</span>phq9.c2)</span></code></pre></div>
<p>Section C:</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="assessment.html#cb112-1"></a><span class="kw">ranova</span>(phq9.m2)</span></code></pre></div>
<pre><code>ANOVA-like table for random-effects: Single term deletions

Model:
phq9 ~ month + tx + (1 | patient) + month:tx
              npar  logLik   AIC    LRT Df Pr(&gt;Chisq)    
&lt;none&gt;           6 -7108.5 14229                         
(1 | patient)    5 -8104.6 16219 1992.1  1  &lt; 2.2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="assessment.html#cb114-1"></a><span class="kw">ranova</span>(phq9.m3)</span></code></pre></div>
<pre><code>ANOVA-like table for random-effects: Single term deletions

Model:
phq9 ~ month + tx + (1 | patient) + (0 + month:tx | patient) + 
    month:tx
                                     npar  logLik   AIC     LRT Df Pr(&gt;Chisq)
&lt;none&gt;                                  7 -7050.9 14116                      
(1 | patient)                           6 -8099.0 16210 2096.20  1  &lt; 2.2e-16
month:tx in (0 + month:tx | patient)    6 -7108.5 14229  115.32  1  &lt; 2.2e-16
                                        
&lt;none&gt;                                  
(1 | patient)                        ***
month:tx in (0 + month:tx | patient) ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Section D:</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="assessment.html#cb116-1"></a>phq9.m2 <span class="op">%&gt;%</span><span class="st"> </span>anova</span></code></pre></div>
<pre><code>Type III Analysis of Variance Table with Satterthwaite&#39;s method
         Sum Sq Mean Sq NumDF  DenDF F value    Pr(&gt;F)    
month    752.05  752.05     1 2244.3 49.4829 2.647e-12 ***
tx        98.93   98.93     1  250.2  6.5092   0.01133 *  
month:tx  90.60   90.60     1 2240.6  5.9612   0.01470 *  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="assessment.html#cb118-1"></a>phq9.m3 <span class="op">%&gt;%</span><span class="st"> </span>anova</span></code></pre></div>
<pre><code>Type III Analysis of Variance Table with Satterthwaite&#39;s method
         Sum Sq Mean Sq NumDF   DenDF F value    Pr(&gt;F)    
month    747.70  747.70     1 2102.47 55.4263 1.407e-13 ***
tx        93.59   93.59     1  248.58  6.9377  0.008969 ** 
month:tx  63.91   63.91     1  330.16  4.7373  0.030224 *  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>

</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-barr2013random">
<p>Barr, Dale J, Roger Levy, Christoph Scheepers, and Harry J Tily. 2013. “Random Effects Structure for Confirmatory Hypothesis Testing: Keep It Maximal.” <em>Journal of Memory and Language</em> 68 (3): 255–78.</p>
</div>
<div id="ref-lynch2018radically">
<p>Lynch, Thomas R, Roelie J Hempel, Ben Whalley, Sarah Byford, Rampaul Chamba, Paul Clarke, Susan Clarke, et al. 2018. “Radically Open Dialectical Behaviour Therapy for Refractory Depression: The Reframed Rct.”</p>
</div>
<div id="ref-lynch2015refractory">
<p>Lynch, TR, B Whalley, RJ Hempel, S Byford, P Clarke, S Clarke, D Kingdon, et al. 2015. “Refractory Depression: Mechanisms and Evaluation of Radically Open Dialectical Behaviour Therapy (Ro-Dbt)[REFRAMED]: Protocol for Randomised Trial.” <em>BMJ Open</em> 5 (7).</p>
</div>
<div id="ref-meteyard2020best">
<p>Meteyard, Lotte, and Robert AI Davies. 2020. “Best Practice Guidance for Linear Mixed-Effects Models in Psychological Science.” <em>Journal of Memory and Language</em> 112: 104092.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="further-reading.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
